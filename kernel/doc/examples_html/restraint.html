<pre><font face="Lucida,Courier New"><font color="#0000C0">/</font><font color="#0000C0">**</font>
 <font color="#0000C0">*</font><font color="#FF8080" style="border: solid 1.5pt #FF0000;"> </font><font color="#FF8080" style="border: solid 1.5pt #FF0000;"> </font><font color="#FF8080" style="border: solid 1.5pt #FF0000;">\</font><font color="#000000">file</font> <font color="#000000">MyRestraint</font><font color="#0000C0">.</font><font color="#000000">h</font><font color="#FF8080" style="border: solid 1.5pt #FF0000;"> </font><font color="#FF8080" style="border: solid 1.5pt #FF0000;"> </font><font color="#FF8080" style="border: solid 1.5pt #FF0000;"> </font><font color="#FF8080" style="border: solid 1.5pt #FF0000;">\</font><font color="#000000">brief</font> <font color="#000000">A</font> <font color="#000000">restraint</font> <font color="#000000">on</font> <font color="#000000">a</font> <font color="#000000">list</font> <font color="#000000">of</font> <font color="#000000">particle</font> <font color="#000000">pairs</font><font color="#0000C0">.</font>
 <font color="#0000C0">*</font>
 <font color="#0000C0">*</font>  <font color="#000000">Copyright</font> <font color="#0080C0">2007</font><font color="#0000C0">-</font><font color="#0080C0">8</font> <font color="#000000">Sali</font> <font color="#000000">Lab</font><font color="#0000C0">.</font> <font color="#000000">All</font> <font color="#000000">rights</font> <font color="#000000">reserved</font><font color="#0000C0">.</font>
 <font color="#0000C0">*</font>
 <font color="#0000C0">*</font><font color="#0000C0">/</font>

<font color="#008000">#ifndef IMPMODULENAME_MY_RESTRAINT_H
</font><font color="#008000">#define IMPMODULENAME_MY_RESTRAINT_H
</font>
<font color="#008000">#include "config.h"
</font><font color="#008000">#include "internal/modulename_version_info.h"
</font><font color="#008000">#include &lt;IMP/SingletonScore.h&gt;
</font><font color="#008000">#include &lt;IMP/Restraint.h&gt;
</font><font color="#008000">#include &lt;IMP/PairContainer.h&gt;
</font>
<font color="#000000">IMPMODULENAME_BEGIN_NAMESPACE</font>

<font color="#0000C0">//</font><font color="#FF8080" style="border: solid 1.5pt #FF0000;">!</font> <font color="#000000">Apply</font> <font color="#000000">a</font> <font color="#000000">PairScore</font> <font color="#000000">to</font> <font color="#000000">a</font> <font color="#000000">list</font> <font color="#000000">of</font> <font color="#000000">particle</font> <font color="#000000">pairs</font>
<font color="#0000C0">/</font><font color="#0000C0">**</font>
 <font color="#0000C0">*</font><font color="#0000C0">/</font>
<font color="#C00000">class</font> <font color="#000000">IMPMODULENAMEEXPORT</font> <font color="#000000">MyRestraint</font> <font color="#0000C0">:</font> <font color="#000000">public</font> <font color="#000000">Restraint</font>
<font color="#0000C0">{</font>
  <font color="#000000">Pointer</font><font color="#0000C0">&lt;</font><font color="#000000">PairContainer</font><font color="#0000C0">&gt;</font> <font color="#000000">pc_</font><font color="#0000C0">;</font>
  <font color="#000000">Pointer</font><font color="#0000C0">&lt;</font><font color="#000000">PairScore</font><font color="#0000C0">&gt;</font> <font color="#000000">f_</font><font color="#0000C0">;</font>
<font color="#000000">public</font><font color="#0000C0">:</font>
  <font color="#0000C0">//</font><font color="#FF8080" style="border: solid 1.5pt #FF0000;">!</font> <font color="#000000">Create</font> <font color="#000000">the</font> <font color="#000000">restraint</font><font color="#0000C0">.</font>
  <font color="#000000">MyRestraint</font><font color="#0000C0">(</font><font color="#000000">PairScore</font><font color="#0000C0">*</font> <font color="#000000">score_func</font><font color="#0000C0">,</font>
              <font color="#000000">PairContainer</font> <font color="#0000C0">*</font><font color="#000000">pc</font><font color="#0000C0">)</font><font color="#0000C0">;</font>
  <font color="#000000">virtual</font> <font color="#0000C0">~</font><font color="#000000">MyRestraint</font><font color="#0000C0">(</font><font color="#0000C0">)</font> <font color="#0000C0">{</font><font color="#0000C0">}</font>

  <font color="#000000">IMP_RESTRAINT</font><font color="#0000C0">(</font><font color="#000000">internal</font><font color="#0000C0">:</font><font color="#0000C0">:</font><font color="#000000">modulename_version_info</font><font color="#0000C0">)</font>

  <font color="#000000">ParticlesList</font> <font color="#000000">get_interacting_particles</font><font color="#0000C0">(</font><font color="#0000C0">)</font> <font color="#000000">const</font><font color="#0000C0">;</font>
<font color="#0000C0">}</font><font color="#0000C0">;</font>

<font color="#000000">IMPMODULENAME_END_NAMESPACE</font>

<font color="#008000">#endif  /* IMPCORE_DISTANCE_RESTRAINT_H */
</font>
<font color="#0000C0">/</font><font color="#0000C0">**</font>
 <font color="#0000C0">*</font><font color="#FF8080" style="border: solid 1.5pt #FF0000;"> </font><font color="#FF8080" style="border: solid 1.5pt #FF0000;"> </font><font color="#FF8080" style="border: solid 1.5pt #FF0000;">\</font><font color="#000000">file</font> <font color="#000000">MyRestraint</font><font color="#0000C0">.</font><font color="#000000">cpp</font><font color="#FF8080" style="border: solid 1.5pt #FF0000;"> </font><font color="#FF8080" style="border: solid 1.5pt #FF0000;">\</font><font color="#000000">brief</font> <font color="#000000">Restrain</font> <font color="#000000">a</font> <font color="#000000">list</font> <font color="#000000">of</font> <font color="#000000">particle</font> <font color="#000000">pairs</font><font color="#0000C0">.</font>
 <font color="#0000C0">*</font>
 <font color="#0000C0">*</font>  <font color="#000000">Copyright</font> <font color="#0080C0">2007</font><font color="#0000C0">-</font><font color="#0080C0">8</font> <font color="#000000">Sali</font> <font color="#000000">Lab</font><font color="#0000C0">.</font> <font color="#000000">All</font> <font color="#000000">rights</font> <font color="#000000">reserved</font><font color="#0000C0">.</font>
 <font color="#0000C0">*</font>
 <font color="#0000C0">*</font><font color="#0000C0">/</font>

<font color="#008000">#include &lt;IMP/modulename/MyRestraint.h&gt;
</font><font color="#008000">#include &lt;IMP/log.h&gt;
</font>
<font color="#000000">IMPMODULENAME_BEGIN_NAMESPACE</font>

<font color="#000000">MyRestraint</font><font color="#0000C0">:</font><font color="#0000C0">:</font><font color="#000000">MyRestraint</font><font color="#0000C0">(</font><font color="#000000">PairScore</font><font color="#0000C0">*</font> <font color="#000000">score_func</font><font color="#0000C0">,</font>
                         <font color="#000000">PairContainer</font> <font color="#0000C0">*</font><font color="#000000">pc</font><font color="#0000C0">)</font> <font color="#0000C0">:</font> <font color="#000000">pc_</font><font color="#0000C0">(</font><font color="#000000">pc</font><font color="#0000C0">)</font><font color="#0000C0">,</font>
                                           <font color="#000000">f_</font><font color="#0000C0">(</font><font color="#000000">score_func</font><font color="#0000C0">)</font> <font color="#0000C0">{</font><font color="#0000C0">}</font>

<font color="#000000">PairsRestraint</font><font color="#0000C0">:</font><font color="#0000C0">:</font><font color="#0000C0">~</font><font color="#000000">PairsRestraint</font><font color="#0000C0">(</font><font color="#0000C0">)</font> <font color="#0000C0">{</font><font color="#0000C0">}</font>

<font color="#000000">Float</font> <font color="#000000">PairsRestraint</font><font color="#0000C0">:</font><font color="#0000C0">:</font><font color="#000000">evaluate</font><font color="#0000C0">(</font><font color="#000000">DerivativeAccumulator</font> <font color="#0000C0">*</font><font color="#000000">accum</font><font color="#0000C0">)</font>
<font color="#0000C0">{</font>
  <font color="#000000">Float</font> <font color="#000000">score</font><font color="#0000C0">=</font><font color="#0080C0">0</font><font color="#0000C0">;</font>
  <font color="#C00000">for</font> <font color="#0000C0">(</font><font color="#000000">PairContainer</font><font color="#0000C0">:</font><font color="#0000C0">:</font><font color="#000000">ParticlePairIterator</font>
       <font color="#000000">it</font><font color="#0000C0">=</font> <font color="#000000">pc_</font><font color="#0000C0">-</font><font color="#0000C0">&gt;</font><font color="#000000">particle_pairs_begin</font><font color="#0000C0">(</font><font color="#0000C0">)</font><font color="#0000C0">;</font>
       <font color="#000000">it</font> <font color="#0000C0">!=</font> <font color="#000000">pc_</font><font color="#0000C0">-</font><font color="#0000C0">&gt;</font><font color="#000000">particle_pairs_end</font><font color="#0000C0">(</font><font color="#0000C0">)</font><font color="#0000C0">;</font> <font color="#0000C0">+</font><font color="#0000C0">+</font><font color="#000000">it</font><font color="#0000C0">)</font> <font color="#0000C0">{</font>
    <font color="#000000">score</font> <font color="#0000C0">+=</font> <font color="#000000">f_</font><font color="#0000C0">-</font><font color="#0000C0">&gt;</font><font color="#000000">evaluate</font><font color="#0000C0">(</font><font color="#000000">it</font><font color="#0000C0">-</font><font color="#0000C0">&gt;</font><font color="#000000">first</font><font color="#0000C0">,</font> <font color="#000000">it</font><font color="#0000C0">-</font><font color="#0000C0">&gt;</font><font color="#000000">second</font><font color="#0000C0">,</font> <font color="#000000">accum</font><font color="#0000C0">)</font><font color="#0000C0">;</font>
  <font color="#0000C0">}</font>

  <font color="#C00000">return</font> <font color="#000000">score</font><font color="#0000C0">;</font>
<font color="#0000C0">}</font>

<font color="#0000C0">//</font> <font color="#000000">the</font> <font color="#000000">interacting</font> <font color="#000000">sets</font> <font color="#000000">are</font> <font color="#000000">pairs</font>
<font color="#000000">ParticlesList</font> <font color="#000000">PairsRestraint</font><font color="#0000C0">:</font><font color="#0000C0">:</font><font color="#000000">get_interacting_particles</font><font color="#0000C0">(</font><font color="#0000C0">)</font> <font color="#000000">const</font>
<font color="#0000C0">{</font>
  <font color="#000000">ParticlesList</font> <font color="#000000">ret</font><font color="#0000C0">;</font>
  <font color="#C00000">for</font> <font color="#0000C0">(</font><font color="#000000">PairContainer</font><font color="#0000C0">:</font><font color="#0000C0">:</font><font color="#000000">ParticlePairIterator</font> <font color="#000000">it</font>
       <font color="#0000C0">=</font> <font color="#000000">pc_</font><font color="#0000C0">-</font><font color="#0000C0">&gt;</font><font color="#000000">particle_pairs_begin</font><font color="#0000C0">(</font><font color="#0000C0">)</font><font color="#0000C0">;</font>
       <font color="#000000">it</font> <font color="#0000C0">!=</font> <font color="#000000">pc_</font><font color="#0000C0">-</font><font color="#0000C0">&gt;</font><font color="#000000">particle_pairs_end</font><font color="#0000C0">(</font><font color="#0000C0">)</font><font color="#0000C0">;</font> <font color="#0000C0">+</font><font color="#0000C0">+</font><font color="#000000">it</font><font color="#0000C0">)</font> <font color="#0000C0">{</font>
    <font color="#000000">Particles</font> <font color="#000000">s</font><font color="#0000C0">;</font>
    <font color="#000000">s</font><font color="#0000C0">.</font><font color="#000000">push_back</font><font color="#0000C0">(</font><font color="#000000">it</font><font color="#0000C0">-</font><font color="#0000C0">&gt;</font><font color="#000000">first</font><font color="#0000C0">)</font><font color="#0000C0">;</font>
    <font color="#000000">s</font><font color="#0000C0">.</font><font color="#000000">push_back</font><font color="#0000C0">(</font><font color="#000000">it</font><font color="#0000C0">-</font><font color="#0000C0">&gt;</font><font color="#000000">second</font><font color="#0000C0">)</font><font color="#0000C0">;</font>
    <font color="#000000">ret</font><font color="#0000C0">.</font><font color="#000000">push_back</font><font color="#0000C0">(</font><font color="#000000">s</font><font color="#0000C0">)</font><font color="#0000C0">;</font>
  <font color="#0000C0">}</font>
  <font color="#C00000">return</font> <font color="#000000">ret</font><font color="#0000C0">;</font>
<font color="#0000C0">}</font>

<font color="#000000">void</font> <font color="#000000">PairsRestraint</font><font color="#0000C0">:</font><font color="#0000C0">:</font><font color="#000000">show</font><font color="#0000C0">(</font><font color="#000000">std</font><font color="#0000C0">:</font><font color="#0000C0">:</font><font color="#000000">ostream</font><font color="#0000C0">&amp;</font> <font color="#000000">out</font><font color="#0000C0">)</font> <font color="#000000">const</font>
<font color="#0000C0">{</font>
  <font color="#000000">out</font> <font color="#0000C0">&lt;&lt;</font> <font color="#004080">"ContainerRestraint with score function "</font><font color="#0000C0">;</font>
  <font color="#000000">ss_</font><font color="#0000C0">-</font><font color="#0000C0">&gt;</font><font color="#000000">show</font><font color="#0000C0">(</font><font color="#000000">out</font><font color="#0000C0">)</font><font color="#0000C0">;</font>
  <font color="#000000">out</font> <font color="#0000C0">&lt;&lt;</font> <font color="#004080">" and container "</font><font color="#0000C0">;</font>
  <font color="#000000">pc_</font><font color="#0000C0">-</font><font color="#0000C0">&gt;</font><font color="#000000">show</font><font color="#0000C0">(</font><font color="#000000">out</font><font color="#0000C0">)</font><font color="#0000C0">;</font>
  <font color="#000000">out</font> <font color="#0000C0">&lt;&lt;</font> <font color="#000000">std</font><font color="#0000C0">:</font><font color="#0000C0">:</font><font color="#000000">endl</font><font color="#0000C0">;</font>
<font color="#0000C0">}</font>

<font color="#000000">IMPMODULENAME_END_NAMESPACE</font><font color="#000000"></font></font></pre>