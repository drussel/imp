<pre><font face="Lucida,Courier New"><font color="#C00000">import</font> <font color="#000000">IMP</font>
<font color="#C00000">import</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font>

<font color="#008000"># This example restraints the diameter of a set of particles to be smaller than 10
</font>
<font color="#000000">diameter</font><font color="#0000C0">=</font><font color="#0080C0">10</font>
<font color="#000000">m</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">Model</font><font color="#0000C0">(</font><font color="#0000C0">)</font>
<font color="#000000">lc</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">ListSingletonContainer</font><font color="#0000C0">(</font><font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">create_xyzr_particles</font><font color="#0000C0">(</font><font color="#000000">m</font><font color="#0000C0">,</font> <font color="#0080C0">20</font><font color="#0000C0">,</font> <font color="#0080C0">1.0</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<font color="#008000"># create a list of all pairs of particles from lc
</font><font color="#000000">ps</font> <font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">AllPairsPairContainer</font><font color="#0000C0">(</font><font color="#000000">lc</font><font color="#0000C0">)</font>

<font color="#000000">h</font><font color="#0000C0">=</font><font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">HarmonicUpperBound</font><font color="#0000C0">(</font><font color="#000000">diameter</font><font color="#0000C0">,</font><font color="#0080C0">1</font><font color="#0000C0">)</font>
<font color="#000000">d</font><font color="#0000C0">=</font><font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">DistancePairScore</font><font color="#0000C0">(</font><font color="#000000">h</font><font color="#0000C0">)</font>
<font color="#008000"># apply d to each pair from ps
</font><font color="#000000">r</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">PairsRestraint</font><font color="#0000C0">(</font><font color="#000000">d</font><font color="#0000C0">,</font> <font color="#000000">ps</font><font color="#0000C0">)</font>
<font color="#000000">m</font><font color="#0000C0">.</font><font color="#000000">add_restraint</font><font color="#0000C0">(</font><font color="#000000">r</font><font color="#0000C0">)</font>

<font color="#008000"># Set up optimizer
</font><font color="#000000">o</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">ConjugateGradients</font><font color="#0000C0">(</font><font color="#0000C0">)</font>
<font color="#000000">o</font><font color="#0000C0">.</font><font color="#000000">set_model</font><font color="#0000C0">(</font><font color="#000000">m</font><font color="#0000C0">)</font>

<font color="#000000">o</font><font color="#0000C0">.</font><font color="#000000">optimize</font><font color="#0000C0">(</font><font color="#0080C0">100</font><font color="#0000C0">)</font>

<font color="#C00000">for</font> <font color="#000000">i</font> <font color="#C00000">in</font> <font color="#000000">range</font><font color="#0000C0">(</font><font color="#0080C0">0</font><font color="#0000C0">,</font> <font color="#000000">ps</font><font color="#0000C0">.</font><font color="#000000">get_number_of_particle_pairs</font><font color="#0000C0">(</font><font color="#0000C0">)</font><font color="#0000C0">)</font><font color="#0000C0">:</font>
    <font color="#000000">p</font><font color="#0000C0">=</font> <font color="#000000">ps</font><font color="#0000C0">.</font><font color="#000000">get_particle_pair</font><font color="#0000C0">(</font><font color="#000000">i</font><font color="#0000C0">)</font>
    <font color="#C00000">print</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">distance</font><font color="#0000C0">(</font><font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">XYZDecorator</font><font color="#0000C0">(</font><font color="#000000">p</font><font color="#0000C0">[</font><font color="#0080C0">0</font><font color="#0000C0">]</font><font color="#0000C0">)</font><font color="#0000C0">,</font>
                            <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">XYZDecorator</font><font color="#0000C0">(</font><font color="#000000">p</font><font color="#0000C0">[</font><font color="#0080C0">1</font><font color="#0000C0">]</font><font color="#0000C0">)</font><font color="#0000C0">)</font><font color="#000000"></font></font></pre>