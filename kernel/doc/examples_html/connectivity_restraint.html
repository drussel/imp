<pre><font face="Lucida,Courier New"><font color="#C00000">import</font> <font color="#000000">IMP</font>
<font color="#C00000">import</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font>
<font color="#C00000">import</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">misc</font>
<font color="#000000">m</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">Model</font><font color="#0000C0">(</font><font color="#0000C0">)</font>

<font color="#008000"># Put the parent particles for each molecule
</font><font color="#000000">hs</font><font color="#0000C0">=</font><font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">Particles</font><font color="#0000C0">(</font><font color="#0000C0">)</font>

<font color="#008000"># create the molecules
</font><font color="#C00000">for</font> <font color="#000000">i</font> <font color="#C00000">in</font> <font color="#000000">range</font><font color="#0000C0">(</font><font color="#0080C0">0</font><font color="#0000C0">,</font><font color="#0080C0">10</font><font color="#0000C0">)</font><font color="#0000C0">:</font>
    <font color="#000000">p</font><font color="#0000C0">=</font><font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">Particle</font><font color="#0000C0">(</font><font color="#000000">m</font><font color="#0000C0">)</font>
    <font color="#000000">d</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">MolecularHierarchyDecorator</font><font color="#0000C0">.</font><font color="#000000">create</font><font color="#0000C0">(</font><font color="#000000">p</font><font color="#0000C0">)</font>
    <font color="#000000">d</font><font color="#0000C0">.</font><font color="#000000">set_type</font><font color="#0000C0">(</font><font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">MolecularHierarchyDecorator</font><font color="#0000C0">.</font><font color="#000000">PROTEIN</font><font color="#0000C0">)</font>
    <font color="#C00000">for</font> <font color="#000000">j</font> <font color="#C00000">in</font> <font color="#000000">range</font><font color="#0000C0">(</font><font color="#0080C0">0</font><font color="#0000C0">,</font><font color="#0080C0">5</font><font color="#0000C0">)</font><font color="#0000C0">:</font>
        <font color="#000000">p</font><font color="#0000C0">=</font><font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">Particle</font><font color="#0000C0">(</font><font color="#000000">m</font><font color="#0000C0">)</font>
        <font color="#000000">cd</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">MolecularHierarchyDecorator</font><font color="#0000C0">.</font><font color="#000000">create</font><font color="#0000C0">(</font><font color="#000000">p</font><font color="#0000C0">)</font>
        <font color="#000000">cd</font><font color="#0000C0">.</font><font color="#000000">set_type</font><font color="#0000C0">(</font><font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">MolecularHierarchyDecorator</font><font color="#0000C0">.</font><font color="#000000">FRAGMENT</font><font color="#0000C0">)</font>
        <font color="#000000">d</font><font color="#0000C0">.</font><font color="#000000">add_child</font><font color="#0000C0">(</font><font color="#000000">cd</font><font color="#0000C0">)</font>
        <font color="#000000">xd</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">XYZRDecorator</font><font color="#0000C0">.</font><font color="#000000">create</font><font color="#0000C0">(</font><font color="#000000">p</font><font color="#0000C0">)</font>
        <font color="#000000">xd</font><font color="#0000C0">.</font><font color="#000000">set_coordinates</font><font color="#0000C0">(</font><font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">Vector3D</font><font color="#0000C0">(</font><font color="#0080C0">3</font><font color="#0000C0">*</font><font color="#000000">i</font><font color="#0000C0">,</font><font color="#000000">j</font><font color="#0000C0">,</font><font color="#0080C0">0</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
        <font color="#000000">xd</font><font color="#0000C0">.</font><font color="#000000">set_radius</font><font color="#0000C0">(</font><font color="#0080C0">1</font><font color="#0000C0">)</font>
    <font color="#000000">hs</font><font color="#0000C0">.</font><font color="#000000">append</font><font color="#0000C0">(</font><font color="#000000">p</font><font color="#0000C0">)</font>

<font color="#000000">ps</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">SphereDistancePairScore</font><font color="#0000C0">(</font><font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">HarmonicUpperBound</font><font color="#0000C0">(</font><font color="#0080C0">0</font><font color="#0000C0">,</font><font color="#0080C0">1</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<font color="#000000">cps</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">ChildrenParticleRefiner</font><font color="#0000C0">(</font><font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">MolecularHierarchyDecorator</font><font color="#0000C0">.</font><font color="#000000">get_traits</font><font color="#0000C0">(</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<font color="#000000">lrps</font> <font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">misc</font><font color="#0000C0">.</font><font color="#000000">LowestRefinedPairScore</font><font color="#0000C0">(</font><font color="#000000">cps</font><font color="#0000C0">,</font><font color="#000000">ps</font><font color="#0000C0">)</font>
<font color="#000000">cr</font> <font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">ConnectivityRestraint</font><font color="#0000C0">(</font><font color="#000000">lrps</font><font color="#0000C0">)</font>
<font color="#000000">cr</font><font color="#0000C0">.</font><font color="#000000">set_particles</font><font color="#0000C0">(</font><font color="#000000">hs</font><font color="#0000C0">)</font>
<font color="#000000">m</font><font color="#0000C0">.</font><font color="#000000">add_restraint</font><font color="#0000C0">(</font><font color="#000000">cr</font><font color="#0000C0">)</font>

<font color="#000000">m</font><font color="#0000C0">.</font><font color="#000000">evaluate</font><font color="#0000C0">(</font><font color="#000000">False</font><font color="#0000C0">)</font><font color="#000000"></font></font></pre>