<pre><font face="Lucida,Courier New"><font color="#C00000">import</font> <font color="#000000">IMP</font>
<font color="#C00000">import</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font>
<font color="#C00000">import</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">modeller</font>

<font color="#000000">m</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">Model</font><font color="#0000C0">(</font><font color="#0000C0">)</font>
<font color="#000000">prot</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">modeller</font><font color="#0000C0">.</font><font color="#000000">read_pdb</font><font color="#0000C0">(</font><font color="#004080">'single_protein.pdb'</font><font color="#0000C0">,</font> <font color="#000000">m</font><font color="#0000C0">)</font>
<font color="#000000">res</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">molecular_hierarchy_get_by_type</font><font color="#0000C0">(</font><font color="#000000">prot</font><font color="#0000C0">,</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">MolecularHierarchyDecorator</font><font color="#0000C0">.</font><font color="#000000">RESIDUE</font><font color="#0000C0">)</font>
<font color="#000000">rc</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">ListSingletonContainer</font><font color="#0000C0">(</font><font color="#000000">res</font><font color="#0000C0">)</font>
<font color="#C00000">for</font> <font color="#000000">p</font> <font color="#C00000">in</font> <font color="#000000">res</font><font color="#0000C0">:</font>
    <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">XYZRDecorator</font><font color="#0000C0">.</font><font color="#000000">create</font><font color="#0000C0">(</font><font color="#000000">p</font><font color="#0000C0">)</font>
<font color="#000000">ref</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">ChildrenParticleRefiner</font><font color="#0000C0">(</font><font color="#0000C0">)</font>
<font color="#000000">cover</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">CoverRefinedSingletonModifier</font><font color="#0000C0">(</font><font color="#000000">ref</font><font color="#0000C0">)</font>
<font color="#000000">propd</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">DerivativesToRefinedSingletonModifier</font><font color="#0000C0">(</font><font color="#000000">ref</font><font color="#0000C0">)</font>
<font color="#000000">state</font><font color="#0000C0">=</font><font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">SingletonsScoreState</font><font color="#0000C0">(</font><font color="#000000">rc</font><font color="#0000C0">,</font> <font color="#000000">cover</font><font color="#0000C0">,</font> <font color="#000000">propd</font><font color="#0000C0">)</font>
<font color="#000000">m</font><font color="#0000C0">.</font><font color="#000000">add_score_state</font><font color="#0000C0">(</font><font color="#000000">state</font><font color="#0000C0">)</font>
<font color="#000000">m</font><font color="#0000C0">.</font><font color="#000000">evaluate</font><font color="#0000C0">(</font><font color="#000000">False</font><font color="#0000C0">)</font><font color="#000000"></font></font></pre>