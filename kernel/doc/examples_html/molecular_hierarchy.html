<pre><font face="Lucida,Courier New"><font color="#C00000">import</font> <font color="#000000">IMP</font>
<font color="#C00000">import</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font>
<font color="#C00000">import</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">modeller</font>

<font color="#000000">m</font> <font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">Model</font><font color="#0000C0">(</font><font color="#0000C0">)</font>
<font color="#000000">mp0</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">modeller</font><font color="#0000C0">.</font><font color="#000000">read_pdb</font><font color="#0000C0">(</font><font color="#004080">'single_protein.pdb'</font><font color="#0000C0">,</font> <font color="#000000">m</font><font color="#0000C0">)</font>
<font color="#008000"># get the 16th residue
</font><font color="#000000">r16</font> <font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">molecular_hierarchy_get_residue</font><font color="#0000C0">(</font><font color="#000000">mp0</font><font color="#0000C0">,</font> <font color="#0080C0">16</font><font color="#0000C0">)</font>
<font color="#000000">r16</font><font color="#0000C0">.</font><font color="#000000">show</font><font color="#0000C0">(</font><font color="#0000C0">)</font>

<font color="#000000">atoms</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">molecular_hierarchy_get_by_type</font><font color="#0000C0">(</font><font color="#000000">mp0</font><font color="#0000C0">,</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">MolecularHierarchyDecorator</font><font color="#0000C0">.</font><font color="#000000">ATOM</font><font color="#0000C0">)</font>
<font color="#C00000">print</font> <font color="#000000">len</font><font color="#0000C0">(</font><font color="#000000">atoms</font><font color="#0000C0">)</font>

<font color="#008000">#get the residues
</font><font color="#000000">residues</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">molecular_hierarchy_get_by_type</font><font color="#0000C0">(</font><font color="#000000">mp0</font><font color="#0000C0">,</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">MolecularHierarchyDecorator</font><font color="#0000C0">.</font><font color="#000000">RESIDUE</font><font color="#0000C0">)</font>
<font color="#008000"># set the coordinates and radius of each residue to enclose its atoms
</font><font color="#C00000">for</font> <font color="#000000">r</font> <font color="#C00000">in</font> <font color="#000000">residues</font><font color="#0000C0">:</font>
    <font color="#000000">d</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">XYZRDecorator</font><font color="#0000C0">.</font><font color="#000000">create</font><font color="#0000C0">(</font><font color="#000000">r</font><font color="#0000C0">)</font>
    <font color="#000000">atoms</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">molecular_hierarchy_get_by_type</font><font color="#0000C0">(</font><font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">MolecularHierarchyDecorator</font><font color="#0000C0">(</font><font color="#000000">r</font><font color="#0000C0">)</font><font color="#0000C0">,</font>
                                                    <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">MolecularHierarchyDecorator</font><font color="#0000C0">.</font><font color="#000000">ATOM</font><font color="#0000C0">)</font>
    <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">set_enclosing_sphere</font><font color="#0000C0">(</font><font color="#000000">atoms</font><font color="#0000C0">,</font> <font color="#000000">d</font><font color="#0000C0">)</font>

<font color="#008000"># load another copy
</font><font color="#000000">mp1</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">modeller</font><font color="#0000C0">.</font><font color="#000000">read_pdb</font><font color="#0000C0">(</font><font color="#004080">'single_protein.pdb'</font><font color="#0000C0">,</font> <font color="#000000">m</font><font color="#0000C0">)</font>

<font color="#000000">p</font> <font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">Particle</font><font color="#0000C0">(</font><font color="#0000C0">)</font>
<font color="#000000">m</font><font color="#0000C0">.</font><font color="#000000">add_particle</font><font color="#0000C0">(</font><font color="#000000">p</font><font color="#0000C0">)</font>
<font color="#000000">rmp</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">MolecularHierarchyDecorator</font><font color="#0000C0">.</font><font color="#000000">create</font><font color="#0000C0">(</font><font color="#000000">p</font><font color="#0000C0">)</font>
<font color="#000000">rmp</font><font color="#0000C0">.</font><font color="#000000">set_type</font><font color="#0000C0">(</font><font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">MolecularHierarchyDecorator</font><font color="#0000C0">.</font><font color="#000000">ASSEMBLY</font><font color="#0000C0">)</font>
<font color="#000000">rmp</font><font color="#0000C0">.</font><font color="#000000">add_child</font><font color="#0000C0">(</font><font color="#000000">mp0</font><font color="#0000C0">)</font>
<font color="#000000">rmp</font><font color="#0000C0">.</font><font color="#000000">add_child</font><font color="#0000C0">(</font><font color="#000000">mp1</font><font color="#0000C0">)</font><font color="#000000"></font></font></pre>