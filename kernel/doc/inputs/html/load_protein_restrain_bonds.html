<pre><font face="Lucida,Courier New"><font color="#000000">prot</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">modeller</font><font color="#0000C0">.</font><font color="#000000">read_pdb</font><font color="#0000C0">(</font><font color="#004080">"some.pdb"</font><font color="#0000C0">)</font>
<font color="#000000">bds</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">get_internal_bonds</font><font color="#0000C0">(</font><font color="#000000">prot</font><font color="#0000C0">)</font>
<font color="#000000">ps</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">Particles</font><font color="#0000C0">(</font><font color="#0000C0">)</font>
<font color="#C00000">for</font> <font color="#000000">b</font> <font color="#C00000">in</font> <font color="#000000">bds</font><font color="#0000C0">:</font>
    <font color="#000000">ps</font><font color="#0000C0">.</font><font color="#000000">append</font><font color="#0000C0">(</font><font color="#000000">b</font><font color="#0000C0">.</font><font color="#000000">get_particle</font><font color="#0000C0">(</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<font color="#000000">bl</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">ListSingletonContainer</font><font color="#0000C0">(</font><font color="#000000">ps</font><font color="#0000C0">)</font>
<font color="#000000">h</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">Harmonic</font><font color="#0000C0">(</font><font color="#0080C0">0</font><font color="#0000C0">,</font><font color="#0080C0">1</font><font color="#0000C0">)</font>
<font color="#000000">bs</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">BondSingletonScore</font><font color="#0000C0">(</font><font color="#000000">h</font><font color="#0000C0">)</font>
<font color="#000000">br</font><font color="#0000C0">=</font> <font color="#000000">IMP</font><font color="#0000C0">.</font><font color="#000000">core</font><font color="#0000C0">.</font><font color="#000000">SingletonsRestraint</font><font color="#0000C0">(</font><font color="#000000">bs</font><font color="#0000C0">,</font> <font color="#000000">bl</font><font color="#0000C0">)</font>
<font color="#000000">m</font><font color="#0000C0">.</font><font color="#000000">add_restraint</font><font color="#0000C0">(</font><font color="#000000">br</font><font color="#0000C0">)</font><font color="#000000"></font></font></pre>