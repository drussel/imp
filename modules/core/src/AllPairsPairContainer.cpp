/**
 *  \file AllPairsPairContainer.cpp   \brief A list of ParticlePairs.
 *
 *  This file is generated by a script (core/tools/make-container).
 *  Do not edit directly.
 *
 *  Copyright 2007-8 Sali Lab. All rights reserved.
 *
 */

#include "IMP/core/AllPairsPairContainer.h"
#include <algorithm>


IMPCORE_BEGIN_NAMESPACE

AllPairsPairContainer::AllPairsPairContainer( SingletonContainer *c): c_(c) {
  a_=-1;
  b_=-1;
}

AllPairsPairContainer::~AllPairsPairContainer(){}


unsigned int AllPairsPairContainer::get_number_of_particle_pairs() const {
  unsigned int n= c_->get_number_of_particles();
  return n*(n-1)/2;
}

//!
ParticlePair AllPairsPairContainer::get_particle_pair(unsigned int i) const {
  IMP_assert(i <  get_number_of_particle_pairs(), "Invalid pair requested");
  if (a_*c_->get_number_of_particles() + b_ > i) {
    a_=1;
    b_=0;
  }
  while (a_*c_->get_number_of_particles() + b_ < i) {
    ++b_;
    if (b_==a_) {
      ++a_;
      b_=0;
    }
  }
  return ParticlePair(c_->get_particle(a_), c_->get_particle(b_));
}

bool
AllPairsPairContainer::get_contains_particle_pair(ParticlePair vt) const {
  return c_->get_contains_particle(vt.first)
      && c_->get_contains_particle(vt.second);
}

void AllPairsPairContainer::show(std::ostream &out) const {
  IMP_CHECK_OBJECT(this);
  out << "AllPairsPairContainer on ";
  c_->show(out);
}

IMPCORE_END_NAMESPACE
