/**
 *  \file SingletonRestraint.cpp
 *  \brief Apply a SingletonScore function to a container of Particle*s .
 *
 *  This file is generated by a script (core/tools/make-container).
 *  Do not edit directly.
 *
 *  Copyright 2007-8 Sali Lab. All rights reserved.
 *
 */

#include "IMP/core/SingletonRestraint.h"
#include <IMP/internal/container_helpers.h>

#include <IMP/log.h>


IMPCORE_BEGIN_NAMESPACE

SingletonRestraint
::SingletonRestraint(SingletonScore *ss,
                     Particle *a):
  ss_(ss),
  v_(a)
{
}

Float SingletonRestraint::evaluate(DerivativeAccumulator *accum)
{

  IMP_CHECK_OBJECT(ss_);

  Float score=0;
  score += IMP::internal::ContainerTraits<Particle>
    ::evaluate(ss_, v_, accum);

  return score;
}


ParticlesList SingletonRestraint::get_interacting_particles() const
{
  if (!IMP::internal::ContainerTraits<Particle>::is_singleton) {
    ParticlesList ret;
    ret.push_back(IMP::internal
                  ::ContainerTraits<Particle>::create_set(v_));
    return ret;
  } else {
    return ParticlesList();
  }
}

void SingletonRestraint::show(std::ostream& out) const
{
  out << "SingletonRestraint with score function ";
  ss_->show(out);
  out << " and " << v_;
  out << std::endl;
}

IMPCORE_END_NAMESPACE
