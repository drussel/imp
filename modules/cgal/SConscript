Import('env')
import scons_tools.gcc

if scons_tools.gcc.get_is_gcc(env):
    cxxflags=[]
    yeslist=['trapping-math',
             'signaling-nans',
             'rounding-math']
    nolist=['finite-math-only',
            'float-store',
            'strict-aliasing',
            'tree-vectorize']
    if scons_tools.gcc.get_version(env)>= 4.3:
        yeslist.append('signed-zeros')
        nolist+=['reciprocal-math', 'associative-math']
    l=['-f'+x for x in nolist]+['-fno-'+x for x in yeslist]
    for f in env['CXXFLAGS']:
        if not f in l:
            cxxflags.append(f)
    cxxflags.append('-DCGAL_DISABLE_ROUNDING_MATH_CHECK')
    cxxflags+= ['-f'+x for x in yeslist]+['-fno-'+x for x in nolist]
    if env['build']!= 'debug':
        cxxflag=cxxflags+['-O1', '-DNDEBUG']
else:
    cxxflags=[]
env.IMPModuleBuild(version='SVN',
                   required_dependencies=["CGAL"],
                   cxxflags=cxxflags)
