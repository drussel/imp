/**
 *  \file AllBipartitePairContainer.cpp   \brief A list of ParticlePairs.
 *
 *  This file is generated by a script (core/tools/make-container).
 *  Do not edit directly.
 *
 *  Copyright 2007-2011 IMP Inventors. AllBipartite rights reserved.
 *
 */

#include "IMP/container/AllBipartitePairContainer.h"
#include <IMP/PairModifier.h>
#include <IMP/SingletonModifier.h>
#include <IMP/PairScore.h>
#include <IMP/SingletonScore.h>
#include <algorithm>


IMPCONTAINER_BEGIN_NAMESPACE

AllBipartitePairContainer
::AllBipartitePairContainer( SingletonContainer *a,
                             SingletonContainer *b,
                             bool):
  a_(a), b_(b){
}

AllBipartitePairContainer
::AllBipartitePairContainer( SingletonContainer *a,
                             SingletonContainer *b,
                             std::string name):
  PairContainer(a->get_model(), name),
  a_(a), b_(b),
  deps_(new DependenciesScoreState(this), a->get_model()){
}



bool
AllBipartitePairContainer::get_contents_changed() const {
  return a_->get_contents_changed() || b_->get_contents_changed();
}

unsigned int
AllBipartitePairContainer::get_number_of_particle_pairs() const {
  return a_->get_number_of_particles()*b_->get_number_of_particles();
}

ParticlePair AllBipartitePairContainer
::get_particle_pair(unsigned int i) const {
  unsigned int a= i%a_->get_number_of_particles();
  unsigned int b= i/a_->get_number_of_particles();
  return ParticlePair(a_->get_particle(a), b_->get_particle(b));
}

bool
AllBipartitePairContainer
::get_contains_particle_pair(const ParticlePair &p) const {
  return a_->get_contains_particle(p[0])
      && b_->get_contains_particle(p[1]);
}

void AllBipartitePairContainer::do_show(std::ostream &out) const {
  IMP_CHECK_OBJECT(this);
  out << "container " << *a_ << " and " << *b_ << std::endl;
}


ParticlesTemp AllBipartitePairContainer::get_contained_particles() const {
  ParticlesTemp ret= a_->get_contained_particles();
  ParticlesTemp b= b_->get_contained_particles();
  ret.insert(ret.end(), b.begin(), b.end());
  return ret;
}


IMPCONTAINER_END_NAMESPACE
